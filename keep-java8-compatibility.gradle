if (JavaVersion.current().java9Compatible) {
    project.afterEvaluate {
        tasks.withType(JavaCompile) {
            def version = "8"
            project.logger.info("Configuring $name to use --release $version")
            options.compilerArgs.addAll(['--release', version])
        }
    }
} else {
    project.logger.warn("-PcrossCompile not supported prior to JDK 9. "
            + "Current JDK is ${JavaVersion.current()}")
}